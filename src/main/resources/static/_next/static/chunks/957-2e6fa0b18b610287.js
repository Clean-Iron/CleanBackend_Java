(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[957],{1720:(e,n,t)=>{"use strict";function a(e){if(!e)return"";let[n,t]=e.split(":"),a=new Date;return a.setHours(+n,+t),a.toLocaleTimeString([],{hour:"numeric",minute:"2-digit"})}t.d(n,{e:()=>a})},3539:()=>{},3747:()=>{},3790:(e,n,t)=>{"use strict";t.d(n,{A:()=>i});var a=t(5155),s=t(2115),l=t(4619),c=t(9521),r=t(1720);t(3539);let i=e=>{let{show:n,onClose:t,empleado:i,date:o,startHour:d,endHour:u,city:m,allEmployees:h=[],onAssigned:p}=e,[x,g]=(0,s.useState)(null),[j,v]=(0,s.useState)([]),[b,N]=(0,s.useState)([]),[y,f]=(0,s.useState)([]),[w,C]=(0,s.useState)([]),[S,k]=(0,s.useState)(""),[D,E]=(0,s.useState)(!1),[A,M]=(0,s.useState)(!1),[L,F]=(0,s.useState)(!1),[H,R]=(0,s.useState)(""),[I,U]=(0,s.useState)([]),T=(0,s.useRef)(null),[O,P]=(0,s.useState)("PUNTUAL"),J=(0,c.p)({startHour:6,endHour:18,stepMinutes:30}),[Y,B]=(0,s.useState)(d||""),[V,_]=(0,s.useState)(u||""),[q,z]=(0,s.useState)(!1),[G,Q]=(0,s.useState)(!1),X=(0,s.useRef)(null),Z=(0,s.useRef)(null),K=(0,s.useRef)(null),[W,$]=(0,s.useState)(!1);(0,s.useEffect)(()=>{n&&(B(d||""),_(u||""))},[n,d,u]),(0,s.useEffect)(()=>{let e=e=>{X.current&&!X.current.contains(e.target)&&$(!1),Z.current&&!Z.current.contains(e.target)&&z(!1),K.current&&!K.current.contains(e.target)&&Q(!1),T.current&&!T.current.contains(e.target)&&M(!1),e.target.closest(".modal-asignacion-dropdown-chip")||e.target.closest(".modal-asignacion-add-empleado-btn")||E(!1),e.target.closest(".modal-asignacion-dropdown-chip")||e.target.closest(".modal-asignacion-add-servicio-btn")||F(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,s.useEffect)(()=>{n&&((0,l.Jq)().then(e=>f(e)).catch(e=>{console.error("Error al obtener servicios:",e),f([])}),(0,l.x_)(m).then(e=>{C(e||[]),U(e||[]),g(null),R("")}).catch(e=>{console.error("Error al obtener clientes por ciudad:",e),C([]),U([])}))},[n,m]);let ee=e=>{j.some(n=>n.document===e.document)||(v([...j,e]),E(!1))},en=e=>{v(j.filter(n=>n.document!==e))},et=e=>{b.some(n=>n.id===e.id)||(N([...b,e]),F(!1))},ea=e=>{N(b.filter(n=>n.id!==e))},es=e=>{g(e),R("".concat(e.name," ").concat(e.surname)),M(!1)},el=e=>{R(e),M(!0);let n=e.trim().toLowerCase();if(!n){U(w);return}U(w.filter(e=>{var t,a,s,l,c,r;let i="".concat(null!==(s=e.name)&&void 0!==s?s:""," ").concat(null!==(l=e.surname)&&void 0!==l?l:"").toLowerCase(),o=(null!==(c=e.document)&&void 0!==c?c:"").toString().toLowerCase(),d=(null!==(r=null===(a=e.addresses)||void 0===a?void 0:null===(t=a.find(e=>e.city===m))||void 0===t?void 0:t.address)&&void 0!==r?r:"").toLowerCase();return i.includes(n)||o.includes(n)||d.includes(n)}))},ec=e=>{var n;return(null===(n=J.find(n=>n.value===e))||void 0===n?void 0:n.label)||(e?(0,r.e)(e):"")},er=async()=>{if(!x||0===b.length){alert("Seleccione un cliente y al menos un servicio");return}if(!Y||!V){alert("Seleccione la hora de inicio y la hora de fin");return}let e=x.addresses.find(e=>e.city===m);if(!e){alert("El cliente no tiene direcci\xf3n en esta ciudad");return}let n={client:x,serviceAddress:e,employees:[i,...j],services:b,date:o,startHour:Y,endHour:V,comments:S,state:"PROGRAMADA",recurrenceType:O};try{await (0,l.GZ)(n),alert("Servicio asignado correctamente"),null==p||p(),t()}catch(e){console.error(e),alert("Error al asignar servicio")}};return n?(0,a.jsx)("div",{className:"modal-overlay",children:(0,a.jsxs)("div",{className:"modal-container",children:[(0,a.jsxs)("div",{className:"modal-datos-superiores",style:{gap:"1rem",flexWrap:"wrap"},children:[(0,a.jsx)("span",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:o}),(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,a.jsx)("span",{children:"Hora Inicio"}),(0,a.jsxs)("div",{className:"dropdown",ref:Z,children:[(0,a.jsxs)("button",{type:"button",className:"dropdown-trigger ".concat(q?"open":""),onClick:()=>z(e=>!e),children:[(0,a.jsx)("span",{children:ec(Y)||"Hora inicio"}),(0,a.jsx)("span",{className:"arrow",children:"▼"})]}),q&&(0,a.jsx)("div",{className:"dropdown-content",children:J.map(e=>{let{value:n,label:t}=e;return(0,a.jsx)("button",{onClick:()=>{B(n),z(!1)},children:t},n)})})]})]}),(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,a.jsx)("span",{children:"Hora Fin"}),(0,a.jsxs)("div",{className:"dropdown",ref:K,children:[(0,a.jsxs)("button",{type:"button",className:"dropdown-trigger ".concat(G?"open":""),onClick:()=>Q(e=>!e),children:[(0,a.jsx)("span",{children:ec(V)||"Hora fin"}),(0,a.jsx)("span",{className:"arrow",children:"▼"})]}),G&&(0,a.jsx)("div",{className:"dropdown-content",children:J.map(e=>{let{value:n,label:t}=e;return(0,a.jsx)("button",{onClick:()=>{_(n),Q(!1)},children:t},n)})})]})]}),(0,a.jsxs)("div",{className:"dropdown",ref:X,children:[(0,a.jsxs)("button",{type:"button",className:"dropdown-trigger ".concat(W?"open":""),onClick:()=>$(e=>!e),children:[(0,a.jsx)("span",{children:O}),(0,a.jsx)("span",{className:"arrow",children:"▼"})]}),W&&(0,a.jsx)("div",{className:"dropdown-content",children:["PUNTUAL","FRECUENTE","QUINCENAL","MENSUAL"].map(e=>(0,a.jsx)("button",{onClick:()=>{P(e),$(!1)},children:e},e))})]})]}),(0,a.jsxs)("div",{className:"modal-asignacion-form-grid",children:[(0,a.jsxs)("div",{className:"modal-chip-section",children:[(0,a.jsx)("label",{children:"Empleados:"}),(0,a.jsxs)("div",{className:"modal-chip-container",children:[(0,a.jsxs)("div",{className:"chips",children:[(0,a.jsxs)("div",{className:"modal-chip",children:[i.name," ",i.surname]}),j.map(e=>(0,a.jsxs)("div",{className:"modal-chip",children:[e.name," ",e.surname,(0,a.jsx)("span",{className:"modal-asignacion-remove-btn",onClick:()=>en(e.document),children:"\xd7"})]},e.document)),(0,a.jsx)("button",{type:"button",className:"modal-asignacion-add-empleado-btn",onClick:()=>E(e=>!e),children:"+"})]}),D&&(0,a.jsxs)("div",{className:"modal-asignacion-dropdown-chip",children:[0===h.length?(0,a.jsx)("div",{className:"modal-asignacion-no-opciones",children:"No hay empleados disponibles"}):h.filter(e=>e.document!==i.document&&!j.find(n=>n.document===e.document)).map(e=>(0,a.jsxs)("button",{onClick:()=>ee(e),children:[e.name," ",e.surname]},e.document)),h.length>0&&0===h.filter(e=>e.document!==i.document&&!j.find(n=>n.document===e.document)).length&&(0,a.jsx)("div",{className:"modal-asignacion-no-opciones",children:"Todos los empleados ya est\xe1n asignados"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Clientes:"}),(0,a.jsxs)("div",{className:"modal-asignacion-dropdown",ref:T,children:[(0,a.jsx)("input",{type:"text",placeholder:"Nombre del Cliente",value:H,onChange:e=>el(e.target.value),onFocus:()=>{M(!0),U(w),!H&&x&&R("".concat(x.name," ").concat(x.surname))},onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),I.length>0&&es(I[0])):"Escape"===e.key&&M(!1)}}),A&&(0,a.jsx)("div",{className:"modal-asignacion-dropdown-content",children:0===I.length?(0,a.jsx)("div",{className:"modal-asignacion-no-opciones",children:0===w.length?"No hay clientes disponibles en ".concat(m):"Sin resultados"}):I.map(e=>{var n;let t=null===(n=e.addresses)||void 0===n?void 0:n.find(e=>e.city===m);return(0,a.jsxs)("button",{onClick:()=>es(e),className:(null==x?void 0:x.document)===e.document?"selected":"",children:[e.name," ",e.surname,t&&(0,a.jsxs)("span",{className:"modal-asignacion-cliente-direccion",children:["\xa0- ",t.address]})]},e.document)})})]})]}),(0,a.jsxs)("div",{className:"modal-chip-section",children:[(0,a.jsx)("label",{children:"Servicios:"}),(0,a.jsxs)("div",{className:"modal-chip-container",children:[(0,a.jsxs)("div",{className:"chips",children:[b.map(e=>(0,a.jsxs)("div",{className:"modal-chip",children:[e.description,(0,a.jsx)("span",{className:"modal-asignacion-remove-btn",onClick:()=>ea(e.id),children:"\xd7"})]},e.id)),(0,a.jsx)("button",{type:"button",className:"modal-asignacion-add-servicio-btn",onClick:()=>F(e=>!e),children:"+"})]}),L&&(0,a.jsx)("div",{className:"modal-asignacion-dropdown-chip",children:0===y.length?(0,a.jsx)("div",{className:"modal-asignacion-no-opciones",children:"No hay servicios disponibles"}):0===y.filter(e=>!b.some(n=>n.id===e.id)).length?(0,a.jsx)("div",{className:"modal-asignacion-no-opciones",children:"Todos los servicios ya est\xe1n asignados"}):y.filter(e=>!b.some(n=>n.id===e.id)).map(e=>(0,a.jsx)("button",{onClick:()=>et(e),children:e.description},e.id))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Comentarios:"}),(0,a.jsx)("textarea",{placeholder:"Comentarios adicionales",rows:3,className:"modal-asignacion-textarea",value:S,onChange:e=>k(e.target.value)})]}),(0,a.jsxs)("div",{className:"modal-asignacion-form-buttons modal-asignacion-full-width",children:[(0,a.jsx)("button",{type:"button",onClick:t,className:"modal-asignacion-btn-cancelar",children:"Cancelar"}),(0,a.jsx)("button",{type:"button",className:"modal-asignacion-btn-confirmar",onClick:er,children:"Asignar"})]})]})]})}):null}},4619:(e,n,t)=>{"use strict";t.d(n,{AX:()=>b,El:()=>h,GZ:()=>l,JV:()=>x,Jq:()=>s,Qb:()=>u,R1:()=>d,Ue:()=>g,VU:()=>m,Yu:()=>c,_U:()=>i,bM:()=>j,co:()=>N,fS:()=>f,g_:()=>v,he:()=>o,qP:()=>w,x_:()=>r,xb:()=>y,z2:()=>p});let a=t(3464).A.create({baseURL:"https://cleaniron-cffqbcg5b9ede6fm.eastus2-01.azurewebsites.net",headers:{"Content-Type":"application/json"}}),s=async()=>{let{data:e}=await a.get("/service/all");return e},l=async e=>{let{data:n}=await a.post("/schedule",e);return n},c=async()=>{let{data:e}=await a.get("/client");return e},r=async e=>{let{data:n}=await a.get("/client/clientsByCity/".concat(encodeURIComponent(e)));return n},i=async e=>{let{data:n}=await a.post("/client",e);return n},o=async e=>{let{data:n}=await a.get("/client/".concat(e));return n},d=async(e,n)=>{await a.put("/client/".concat(e),n)},u=async e=>{await a.delete("/client/".concat(e))},m=async()=>{let{data:e}=await a.get("/employee");return e},h=async e=>{let{data:n}=await a.get("/employee/".concat(e));return n},p=async e=>{let{data:n}=await a.post("/employee",e);return n},x=async e=>{let{data:n}=await a.get("/employee/city/".concat(encodeURIComponent(e)));return n},g=async(e,n)=>{let{data:t}=await a.patch("/employee/update/".concat(e),n);return t},j=async e=>{await a.delete("/employee/delete/".concat(e))},v=async(e,n,t,s)=>{let{data:l}=await a.get("/employee/available",{params:{date:e,startHour:n,endHour:t,city:s}});return l},b=async(e,n,t)=>{let{data:s}=await a.get("/schedule/servicesEmployee/".concat(e),{params:{year:n,month:t}});return s},N=async e=>{let{data:n}=await a.get("/schedule/".concat(e));return n},y=async(e,n,t,s)=>{let l={};t&&(l.city=t),e&&(l.name=e),n&&(l.surname=n);let c=Object.keys(l).length?{params:l}:{},{data:r}=await a.get("/schedule/".concat(s,"/filter"),c);return r},f=async(e,n)=>{console.log("Actualizando servicio:",e,n);let{data:t}=await a.patch("/schedule/".concat(e),n);return t},w=async e=>{await a.delete("/schedule/".concat(e))}},5957:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>p});var a=t(5155),s=t(2115),l=t(6874),c=t.n(l),r=t(4619),i=t(9521);t(3747);var o=t(6709),d=t(3790),u=t(1720);let m=e=>{let{employee:n,dataServicios:t=[],onDateSelect:l,onButtonClick:c,initialDate:r=null,minDate:i=null,maxDate:m=null,currentMonth:h=null,currentYear:p=null,hideNavigation:x=!1,onServiceUpdate:g,buttonLabels:j=["TURNO 1","TURNO 2"]}=e,[v,b]=(0,s.useState)(()=>null!==h&&null!==p?new Date(p,h,1):new Date),[N,y]=(0,s.useState)(()=>{if(r){let e=new Date(r);return isNaN(e.getTime())?new Date:e}return new Date}),[f,w]=(0,s.useState)(null),[C,S]=(0,s.useState)(!1),[k,D]=(0,s.useState)(null),[E,A]=(0,s.useState)(!1),[M,L]=(0,s.useState)({date:"",shiftIndex:0});(0,s.useEffect)(()=>{null!==h&&null!==p&&b(new Date(p,h,1))},[h,p]);let F=v.getFullYear(),H=v.getMonth(),R=new Date(F,H+1,0).getDate(),I=(0,s.useMemo)(()=>{let e=new Date(F,H,1).getDay();return 0===e?6:e-1},[F,H]),U=(0,s.useCallback)(e=>{if(!e||isNaN(e.getTime()))return"";let n=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return"".concat(n,"-").concat(t,"-").concat(a)},[]),T=(0,s.useCallback)(e=>{let n=new Date;return e===n.getDate()&&H===n.getMonth()&&F===n.getFullYear()},[H,F]),O=(0,s.useCallback)(e=>N.getDate()===e&&N.getMonth()===H&&N.getFullYear()===F,[N,H,F]),P=(0,s.useCallback)(e=>{let n=new Date(F,H,e);return i&&n<i||m&&n>m},[F,H,i,m]),J=(0,s.useCallback)((e,n)=>{if(P(e))return;let t=new Date(F,H,e),a=U(t);y(t),w({day:e,buttonIndex:n,date:a}),null==l||l(a),null==c||c(a,n,j[n])},[F,H,P,U,l,c,j]),Y=(0,s.useCallback)((e,n)=>(null==f?void 0:f.day)===e&&(null==f?void 0:f.buttonIndex)===n,[f]),B=(0,s.useMemo)(()=>{let e=[];for(let n=0;n<I;n++)e.push((0,a.jsx)("div",{className:"modern-date-empty"},"empty-".concat(n)));for(let n=1;n<=R;n++){let s=U(new Date(F,H,n)),l=t.filter(e=>e.serviceDate===s),c=[l.find(e=>e.startHour<"13:00:00"),l.find(e=>e.startHour>="13:00:00")],r=l.reduce((e,n)=>e+(n.totalServiceHours||0),0)>=8,i=T(n),o=O(n),d=P(n),m=["modern-date-container",i&&"modern-date-container-today",o&&"modern-date-container-selected",d&&"modern-date-container-disabled"].filter(Boolean).join(" ");e.push((0,a.jsxs)("div",{className:m,children:[(0,a.jsx)("div",{className:"modern-date-number",children:n}),(0,a.jsx)("div",{className:"modern-date-buttons",children:c.map((e,t)=>{let c=e?e.recurrenceType:r&&l.length>0?l[0].recurrenceType:null,i=null;switch(c){case"PUNTUAL":i="#3B82F6";break;case"FRECUENTE":i="#10B981";break;case"QUINCENAL":i="#FBBF24";break;case"MENSUAL":i="#EF4444"}let o=null;e?o=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{children:"".concat((0,u.e)(e.startHour)," ").concat((0,u.e)(e.endHour))}),(0,a.jsx)("div",{className:"modern-btn-client",children:e.clientCompleteName})]}):r||(o=j[t]);let m=i?{backgroundColor:i,color:"#FFFFFF"}:{},h=["modern-date-button",Y(n,t)&&"modern-date-button-selected",d&&"modern-date-button-disabled"].filter(Boolean).join(" ");return(0,a.jsx)("button",{className:h,style:m,disabled:d,"aria-pressed":Y(n,t),onClick:()=>{J(n,t),e?(D(e),S(!0)):r||(L({date:s,shiftIndex:t}),A(!0))},children:o},"".concat(n,"-").concat(t))})})]},"day-".concat(n)))}return e},[I,R,T,O,P,J,Y,t,U,j]);return(0,a.jsxs)("div",{className:"modern-calendar",role:"application","aria-label":"Calendario de selecci\xf3n de fechas",children:[(0,a.jsx)("div",{className:"modern-month-header",children:(0,a.jsxs)("h2",{className:"modern-month-title ".concat(x?"centered":""),children:[["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][H]," ",F]})}),(0,a.jsx)("div",{className:"modern-weekdays",children:["Lun","Mar","Mi\xe9","Jue","Vie","S\xe1b","Dom"].map((e,n)=>(0,a.jsx)("div",{className:"modern-weekday",children:e},n))}),(0,a.jsx)("div",{className:"modern-calendar-grid",children:B}),C&&k&&(0,a.jsx)(o.A,{service:k,onClose:()=>{S(!1),D(null)},onUpdate:()=>{S(!1),D(null),null==g||g()}}),E&&(0,a.jsx)(d.A,{show:E,onClose:()=>A(!1),empleado:n,date:M.date,startHour:0===M.shiftIndex?"06:00":"14:00",endHour:0===M.shiftIndex?"14:00":"22:00",city:null==n?void 0:n.city,onAssigned:()=>{A(!1),null==g||g()}})]})};t(9471);let h=e=>{let{onDateSelect:n,onButtonClick:t,initialDate:l=null,minDate:c=null,maxDate:r=null,currentMonth:i=null,currentYear:o=null,hideNavigation:d=!1,buttonLabels:u=["DISPONIBLE","OCUPADO","PERMISO/VAC"]}=e,[m,h]=(0,s.useState)(()=>null!==i&&null!==o?new Date(o,i,1):new Date),[p,x]=(0,s.useState)(()=>{if(l){let e=new Date(l);return isNaN(e.getTime())?new Date:e}return new Date}),[g,j]=(0,s.useState)(null);(0,s.useEffect)(()=>{null!==i&&null!==o&&h(new Date(o,i,1))},[i,o]);let v=m.getFullYear(),b=m.getMonth(),N=new Date(v,b+1,0).getDate(),y=(0,s.useMemo)(()=>{let e=new Date(v,b,1).getDay();return 0===e?6:e-1},[v,b]),f=(0,s.useCallback)(e=>{if(!e||isNaN(e.getTime()))return"";let n=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return"".concat(n,"-").concat(t,"-").concat(a)},[]),w=(0,s.useCallback)(e=>{let n=new Date;return e===n.getDate()&&b===n.getMonth()&&v===n.getFullYear()},[b,v]),C=(0,s.useCallback)(e=>p.getDate()===e&&p.getMonth()===b&&p.getFullYear()===v,[p,b,v]),S=(0,s.useCallback)(e=>{let n=new Date(v,b,e);return c&&n<c||r&&n>r},[v,b,c,r]),k=(0,s.useCallback)((e,a)=>{if(S(e))return;let s=new Date(v,b,e),l=f(s);x(s),j({day:e,buttonIndex:a,date:l}),null==n||n(l),null==t||t(l,a,u[a])},[v,b,S,f,n,t,u]),D=(0,s.useCallback)((e,n)=>(null==g?void 0:g.day)===e&&(null==g?void 0:g.buttonIndex)===n,[g]),E=(0,s.useMemo)(()=>{let e=[];for(let n=0;n<y;n++)e.push((0,a.jsx)("div",{className:"calendar-date-empty"},"empty-".concat(n)));for(let n=1;n<=N;n++){let t=w(n),s=C(n),l=S(n),c=["calendar-date-container",t&&"calendar-date-container-today",s&&"calendar-date-container-selected",l&&"calendar-date-container-disabled"].filter(Boolean).join(" ");e.push((0,a.jsxs)("div",{className:c,children:[(0,a.jsx)("div",{className:"calendar-date-number",children:n}),(0,a.jsx)("div",{className:"calendar-date-buttons",children:u.map((e,t)=>{let s=D(n,t),c=["calendar-date-button","calendar-date-button-".concat(t),s&&"calendar-date-button-selected",l&&"calendar-date-button-disabled"].filter(Boolean).join(" ");return(0,a.jsx)("button",{className:c,onClick:()=>k(n,t),disabled:l,"aria-label":"".concat(e," del ").concat(n," de ").concat(m.toLocaleDateString("es-ES",{month:"long"})," ").concat(v),"aria-pressed":s,children:e},"".concat(n,"-").concat(t))})})]},"day-".concat(n)))}return e},[y,N,w,C,S,k,D,m,v,u]);return(0,a.jsxs)("div",{className:"three-button-calendar",role:"application","aria-label":"Calendario de selecci\xf3n de fechas",children:[(0,a.jsx)("div",{className:"calendar-month-header",children:(0,a.jsxs)("h2",{className:"calendar-month-title ".concat(d?"centered":""),children:[["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][b]," ",v]})}),(0,a.jsx)("div",{className:"calendar-weekdays",children:["Lun","Mar","Mi\xe9","Jue","Vie","S\xe1b","Dom"].map((e,n)=>(0,a.jsx)("div",{className:"calendar-weekday",children:e},n))}),(0,a.jsx)("div",{className:"calendar-grid",children:E})]})},p=()=>{let[e,n]=(0,s.useState)(""),[t,l]=(0,s.useState)(new Date().getMonth()),[o,d]=(0,s.useState)(new Date().getFullYear()),[u,p]=(0,s.useState)(""),{ciudades:x,isLoading:g,isError:j}=(0,i.k)(),[v,b]=(0,s.useState)([]),[N,y]=(0,s.useState)(null),[f,w]=(0,s.useState)([]),[C,S]=(0,s.useState)(!1),[k,D]=(0,s.useState)(!1),[E,A]=(0,s.useState)(!1),[M,L]=(0,s.useState)(""),[F,H]=(0,s.useState)([]),[R,I]=(0,s.useState)(!1),U=(0,s.useRef)(null),T=(0,s.useRef)(null),O=(0,s.useRef)(null),P=(0,s.useRef)(null),J=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],Y=new Date().getFullYear(),B=Array.from({length:11},(e,n)=>Y-5+n);(0,s.useEffect)(()=>{u?(0,r.JV)(u).then(e=>{let n=e||[];b(n),y(null),L(""),H(n)}).catch(()=>{b([]),y(null),L(""),H([])}):(b([]),y(null),L(""),H([]))},[u]),(0,s.useEffect)(()=>{if(!N){w([]);return}let e=t+1;(0,r.AX)(N.document,o,e).then(e=>w(e)).catch(e=>{console.error(e),w([])})},[N,t,o]),(0,s.useEffect)(()=>{let e=e=>{T.current&&!T.current.contains(e.target)&&S(!1),O.current&&!O.current.contains(e.target)&&D(!1),P.current&&!P.current.contains(e.target)&&A(!1),U.current&&!U.current.contains(e.target)&&I(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let V=(e,n)=>{l(n),S(!1)},_=e=>{d(e),D(!1)},q=e=>{p(e),A(!1)},z=e=>{L(e),I(!0);let n=e.trim().toLowerCase();if(!n){H(v);return}H(v.filter(e=>{var t,a,s;let l="".concat(null!==(t=e.name)&&void 0!==t?t:""," ").concat(null!==(a=e.surname)&&void 0!==a?a:"").toLowerCase(),c=(null!==(s=e.document)&&void 0!==s?s:"").toString().toLowerCase();return l.includes(n)||c.includes(n)}))},G=e=>{y(e),L("".concat(e.name," ").concat(e.surname)),I(!1)};return(0,a.jsx)("div",{style:{width:"100vw",height:"180vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",position:"relative"},children:(0,a.jsxs)("div",{className:"container",style:{height:"170vh",marginLeft:"0.5cm",marginTop:"0.5cm"},children:[(0,a.jsxs)("div",{style:{width:"240px",height:"100%",marginRight:"auto",padding:"20px",boxShadow:"2px 0px 10px rgba(0, 0, 0, 0.2)",display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,a.jsxs)(c(),{href:"/servicios",className:"btn-53",children:[(0,a.jsx)("div",{className:"original",children:"⬅ Regresar"}),(0,a.jsxs)("div",{className:"letters",children:[(0,a.jsx)("span",{children:"M"}),(0,a.jsx)("span",{children:"E"}),(0,a.jsx)("span",{children:"N"}),(0,a.jsx)("span",{children:"\xda"})]})]}),(0,a.jsx)("div",{className:"menu-buttons",children:(0,a.jsxs)("ul",{children:[(0,a.jsx)("li",{children:(0,a.jsxs)("div",{className:"dropdown",ref:T,children:[(0,a.jsxs)("button",{type:"button",className:"dropdown-trigger ".concat(C?"open":""),onClick:()=>S(!C),children:[(0,a.jsx)("span",{children:J[t]}),(0,a.jsx)("span",{className:"arrow",children:"▼"})]}),C&&(0,a.jsx)("div",{className:"dropdown-content",children:J.map((e,n)=>(0,a.jsx)("button",{type:"button",className:t===n?"selected":"",onClick:()=>V(e,n),children:e},n))})]})}),(0,a.jsx)("li",{children:(0,a.jsxs)("div",{className:"dropdown",ref:O,children:[(0,a.jsxs)("button",{type:"button",className:"dropdown-trigger ".concat(k?"open":""),onClick:()=>D(!k),children:[(0,a.jsx)("span",{children:o}),(0,a.jsx)("span",{className:"arrow",children:"▼"})]}),k&&(0,a.jsx)("div",{className:"dropdown-content",children:B.map(e=>(0,a.jsx)("button",{type:"button",className:o===e?"selected":"",onClick:()=>_(e),children:e},e))})]})}),(0,a.jsx)("li",{children:(0,a.jsxs)("div",{className:"dropdown",ref:P,children:[(0,a.jsxs)("button",{type:"button",className:"dropdown-trigger ".concat(E?"open":""," ").concat(u?"city-selected":""),onClick:()=>A(!E),children:[(0,a.jsx)("span",{children:u||"Seleccionar ciudad"}),(0,a.jsx)("span",{className:"arrow",children:"▼"})]}),E&&(0,a.jsxs)("div",{className:"dropdown-content",children:[u&&(0,a.jsx)("button",{type:"button",className:"clear-option",onClick:()=>q(""),children:"Limpiar selecci\xf3n"}),g&&(0,a.jsx)("div",{children:"Cargando ciudades..."}),j&&(0,a.jsx)("div",{children:"Error al cargar ciudades"}),!g&&!j&&x.map((e,n)=>(0,a.jsx)("button",{type:"button",className:u===e?"selected":"",onClick:()=>q(e),children:e},n))]})]})}),v.length>0&&(0,a.jsx)("li",{children:(0,a.jsxs)("div",{className:"dropdown",ref:U,children:[(0,a.jsx)("input",{type:"text",placeholder:"Selec. empleado",value:M,onChange:e=>z(e.target.value),onFocus:()=>{I(!0),H(v)}}),R&&F.length>0&&(0,a.jsx)("div",{className:"dropdown-content",children:F.map(e=>(0,a.jsxs)("button",{type:"button",className:(null==N?void 0:N.document)===e.document?"selected":"",onClick:()=>G(e),children:[e.name," ",e.surname]},e.document))})]})})]})})]}),N?(0,a.jsx)(m,{employee:N,dataServicios:f,onDateSelect:n,currentMonth:t,currentYear:o,hideNavigation:!0,onServiceUpdate:()=>{if(!N){w([]);return}let e=t+1;(0,r.AX)(N.document,o,e).then(e=>w(e)).catch(e=>{console.error(e),w([])})}}):(0,a.jsx)(h,{onDateSelect:n,onButtonClick:(e,n,t)=>console.log("".concat(t," seleccionado para ").concat(e,", empleado: ").concat((null==N?void 0:N.name)||"ninguno")),currentMonth:t,currentYear:o,hideNavigation:!0,buttonLabels:["DISPONIBLE","OCUPADO","PERMISO/VAC"]})]})})}},6709:(e,n,t)=>{"use strict";t.d(n,{A:()=>i});var a=t(5155),s=t(2115),l=t(4619),c=t(9521),r=t(1720);let i=e=>{let{service:n,onClose:t,onUpdate:i}=e,[o,d]=(0,s.useState)(n.serviceDate),u=(0,c.p)({startHour:6,endHour:18,stepMinutes:30}),[m,h]=(0,s.useState)([]),[p,x]=(0,s.useState)([]),[g,j]=(0,s.useState)([]),[v,b]=(0,s.useState)([]),[N,y]=(0,s.useState)(""),[f,w]=(0,s.useState)(n.startHour||""),[C,S]=(0,s.useState)(n.endHour||""),[k,D]=(0,s.useState)(n.state||""),[E,A]=(0,s.useState)(!1),[M,L]=(0,s.useState)(!1),[F,H]=(0,s.useState)(!1),[R,I]=(0,s.useState)(!1),[U,T]=(0,s.useState)(!1),O=(0,s.useRef)(null),P=(0,s.useRef)(null),J=(0,s.useRef)(null);(0,s.useEffect)(()=>{n.services&&h(n.services.map(e=>({id:e.idService,description:e.serviceDescription}))),n.employees&&x(n.employees.map(e=>({document:e.employeeDocument,employeeCompleteName:e.employeeCompleteName}))),y(n.comments||""),(0,l.VU)().then(b).catch(()=>b([])),(0,l.Jq)().then(j).catch(()=>j([]))},[n]),(0,s.useEffect)(()=>{let e=e=>{O.current&&!O.current.contains(e.target)&&A(!1),P.current&&!P.current.contains(e.target)&&L(!1),J.current&&!J.current.contains(e.target)&&H(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let Y=async()=>{let e={...n,date:o,startHour:f,endHour:C,state:k,employeeDocuments:p.map(e=>e.document),idServices:m.map(e=>e.id),comments:N};await (0,l.fS)(n.id,e),null==i||i(),t()},B=async()=>{confirm("\xbfEliminar este servicio?")&&(await (0,l.qP)(n.id),null==i||i(),t())};return(0,a.jsx)("div",{className:"modal-overlay",onClick:t,children:(0,a.jsxs)("div",{className:"modal-container",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"modal-datos-superiores",style:{justifyContent:"flex-start",gap:"2rem"},children:[(0,a.jsx)("input",{type:"date",value:o,onChange:e=>d(e.target.value)}),(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,a.jsx)("span",{children:"Hora Inicio"}),(0,a.jsxs)("div",{className:"dropdown",ref:O,children:[(0,a.jsxs)("button",{type:"button",className:"dropdown-trigger ".concat(E?"open":""),onClick:()=>A(e=>!e),children:[(0,a.jsx)("span",{children:(0,r.e)(f)||"Hora inicio"}),(0,a.jsx)("span",{className:"arrow",children:"▼"})]}),E&&(0,a.jsx)("div",{className:"dropdown-content",children:u.map(e=>{let{value:n,label:t}=e;return(0,a.jsx)("button",{onClick:()=>{w(n),A(!1)},children:t},n)})})]})]}),(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,a.jsx)("span",{children:"Hora Fin"}),(0,a.jsxs)("div",{className:"dropdown",ref:P,children:[(0,a.jsxs)("button",{type:"button",className:"dropdown-trigger ".concat(M?"open":""),onClick:()=>L(e=>!e),children:[(0,a.jsx)("span",{children:(0,r.e)(C)||"Hora fin"}),(0,a.jsx)("span",{className:"arrow",children:"▼"})]}),M&&(0,a.jsx)("div",{className:"dropdown-content",children:u.map(e=>{let{value:n,label:t}=e;return(0,a.jsx)("button",{onClick:()=>{S(n),L(!1)},children:t},n)})})]})]}),(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,a.jsx)("span",{children:"Estado"}),(0,a.jsxs)("div",{className:"dropdown",ref:J,children:[(0,a.jsxs)("button",{type:"button",className:"dropdown-trigger ".concat(F?"open":""),onClick:()=>H(e=>!e),children:[(0,a.jsx)("span",{children:k||"Estado"}),(0,a.jsx)("span",{className:"arrow",children:"▼"})]}),F&&(0,a.jsx)("div",{className:"dropdown-content",children:["PROGRAMADA","COMPLETADA","CANCELADA"].map(e=>(0,a.jsx)("button",{onClick:()=>{D(e),H(!1)},children:e},e))})]})]})]}),(0,a.jsxs)("div",{className:"modal-asignacion-form-grid",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Cliente"}),(0,a.jsx)("input",{type:"text",readOnly:!0,value:n.clientCompleteName||""})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Direcci\xf3n"}),(0,a.jsx)("input",{type:"text",readOnly:!0,value:n.addressService||""})]}),(0,a.jsxs)("div",{className:"modal-chip-section",children:[(0,a.jsx)("label",{children:"Servicios:"}),(0,a.jsxs)("div",{className:"modal-chip-container",children:[(0,a.jsxs)("div",{className:"chips",children:[m.map(e=>(0,a.jsxs)("div",{className:"modal-chip",children:[e.description,(0,a.jsx)("span",{className:"modal-asignacion-remove-btn",onClick:()=>h(m.filter(n=>n.id!==e.id)),children:"\xd7"})]},e.id)),(0,a.jsx)("button",{type:"button",className:"modal-asignacion-add-servicio-btn",onClick:()=>I(e=>!e),children:"+"})]}),R&&(0,a.jsx)("div",{className:"modal-asignacion-dropdown-chip",children:g.filter(e=>!m.find(n=>n.id===e.id)).map(e=>(0,a.jsx)("button",{onClick:()=>{h([...m,{id:e.id,description:e.description}]),I(!1)},children:e.description},e.id))})]})]}),(0,a.jsxs)("div",{className:"modal-chip-section",children:[(0,a.jsx)("label",{children:"Personal Asignado:"}),(0,a.jsxs)("div",{className:"modal-chip-container",children:[(0,a.jsxs)("div",{className:"chips",children:[p.map(e=>(0,a.jsxs)("div",{className:"modal-chip",children:[e.employeeCompleteName,(0,a.jsx)("span",{className:"modal-asignacion-remove-btn",onClick:()=>x(p.filter(n=>n.document!==e.document)),children:"\xd7"})]},e.document)),(0,a.jsx)("button",{type:"button",className:"modal-asignacion-add-empleado-btn",onClick:()=>T(e=>!e),children:"+"})]}),U&&(0,a.jsx)("div",{className:"modal-asignacion-dropdown-chip",children:v.filter(e=>!p.some(n=>n.document===e.document)).map(e=>(0,a.jsxs)("button",{onClick:()=>{x([...p,{document:e.document,employeeCompleteName:"".concat(e.name," ").concat(e.surname)}]),T(!1)},children:[e.name," ",e.surname]},e.document))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Ciudad"}),(0,a.jsx)("input",{type:"text",readOnly:!0,value:n.city||""})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Comentarios"}),(0,a.jsx)("textarea",{rows:3,className:"modal-asignacion-textarea",value:N,onChange:e=>y(e.target.value)})]})]}),(0,a.jsxs)("div",{className:"modal-asignacion-form-buttons",children:[(0,a.jsx)("button",{className:"modal-asignacion-btn-confirmar",onClick:Y,children:"Guardar Cambios"}),(0,a.jsx)("button",{className:"modal-asignacion-btn-eliminar",onClick:B,children:"Eliminar"}),(0,a.jsx)("button",{className:"modal-asignacion-btn-cancelar",onClick:t,children:"Cerrar"})]})]})})}},9471:()=>{},9521:(e,n,t)=>{"use strict";t.d(n,{k:()=>c,p:()=>r});var a=t(838),s=t(2115);let l=e=>fetch(e).then(e=>{if(!e.ok)throw Error("Error al cargar ciudades");return e.json()});function c(){let e="https://cleaniron-cffqbcg5b9ede6fm.eastus2-01.azurewebsites.net",{data:n,error:t}=(0,a.Ay)(e?"".concat(e,"/address/cities"):null,l);return{ciudades:n||[],isLoading:!t&&!n,isError:!!t}}function r(){let{startHour:e=6,endHour:n=18,stepMinutes:t=30}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.useMemo)(()=>{let a=[];for(let s=e;s<n;s++)for(let e=0;e<60;e+=t){let n="".concat(String(s).padStart(2,"0"),":").concat(String(e).padStart(2,"0"),":00"),t=new Date;t.setHours(s,e);let l=t.toLocaleTimeString([],{hour:"numeric",minute:"2-digit"});a.push({value:n,label:l})}return a},[e,n,t])}}}]);