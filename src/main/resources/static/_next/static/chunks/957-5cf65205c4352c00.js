(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[957],{1720:(e,n,a)=>{"use strict";function t(e){if(!e)return"";let[n,a]=e.split(":"),t=new Date;return t.setHours(+n,+a),t.toLocaleTimeString([],{hour:"numeric",minute:"2-digit"})}a.d(n,{e:()=>t})},3539:()=>{},3747:()=>{},3790:(e,n,a)=>{"use strict";a.d(n,{A:()=>i});var t=a(5155),s=a(2115),l=a(4619),c=a(1720);a(3539);let i=e=>{let{show:n,onClose:a,empleado:i,date:r,startHour:o,endHour:d,city:u,allEmployees:m=[],onAssigned:h}=e,[p,x]=(0,s.useState)(null),[j,g]=(0,s.useState)([]),[v,N]=(0,s.useState)([]),[b,y]=(0,s.useState)([]),[w,f]=(0,s.useState)([]),[C,S]=(0,s.useState)(""),[k,D]=(0,s.useState)(!1),[E,A]=(0,s.useState)(!1),[M,F]=(0,s.useState)(!1),[L,U]=(0,s.useState)("PUNTUAL"),[R,I]=(0,s.useState)(!1),T=(0,s.useRef)(null);(0,s.useEffect)(()=>{let e=e=>{T.current&&!T.current.contains(e.target)&&I(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,s.useEffect)(()=>{n&&((0,l.Jq)().then(e=>{y(e)}).catch(e=>{console.error("Error al obtener servicios:",e),y([])}),(0,l.x_)(u).then(e=>{f(e)}).catch(e=>{console.error("Error al obtener clientes por ciudad:",e),f([])}))},[n,u]);let H=e=>{j.some(n=>n.document===e.document)||(g([...j,e]),D(!1))},O=e=>{g(j.filter(n=>n.document!==e))},P=e=>{v.some(n=>n.id===e.id)||(N([...v,e]),F(!1))},J=e=>{N(v.filter(n=>n.id!==e))},Y=e=>{x(e),A(!1)},B=async()=>{if(!p||0===v.length){alert("Seleccione un cliente y al menos un servicio");return}let e=p.addresses.find(e=>e.city===u);if(!e){alert("El cliente no tiene direcci\xf3n en esta ciudad");return}let n={client:p,serviceAddress:e,employees:[i,...j],services:v,date:r,startHour:o,endHour:d,comments:C,state:"PROGRAMADA",recurrenceType:L};try{await (0,l.GZ)(n),alert("Servicio asignado correctamente"),null==h||h(),a()}catch(e){console.error(e),alert("Error al asignar servicio")}};return(0,t.jsx)("div",{className:"modal-overlay",children:(0,t.jsxs)("div",{className:"modal-container",children:[(0,t.jsxs)("div",{className:"modal-datos-superiores",children:[(0,t.jsxs)("span",{children:[(0,t.jsx)("strong",{children:"Fecha:"})," ",r]}),(0,t.jsxs)("span",{children:[(0,t.jsx)("strong",{children:"Hora:"})," ",(0,c.e)(o)," - ",(0,c.e)(d)]}),(0,t.jsxs)("span",{children:[(0,t.jsx)("strong",{children:"Ciudad:"})," ",u]}),(0,t.jsxs)("div",{className:"dropdown",ref:T,children:[(0,t.jsxs)("button",{type:"button",className:"dropdown-trigger ".concat(R?"open":""),onClick:()=>I(e=>!e),children:[(0,t.jsx)("span",{children:L}),(0,t.jsx)("span",{className:"arrow",children:"▼"})]}),R&&(0,t.jsx)("div",{className:"dropdown-content",children:["PUNTUAL","QUINCENAL","MENSUAL","FRECUENTE"].map(e=>(0,t.jsx)("button",{onClick:()=>{U(e),I(!1)},children:e},e))})]})]}),(0,t.jsxs)("div",{className:"modal-asignacion-form-grid",children:[(0,t.jsxs)("div",{className:"modal-chip-section",children:[(0,t.jsx)("label",{children:"Empleados:"}),(0,t.jsxs)("div",{className:"modal-chip-container",children:[(0,t.jsxs)("div",{className:"chips",children:[(0,t.jsxs)("div",{className:"modal-chip",children:[i.name," ",i.surname]}),j.map(e=>(0,t.jsxs)("div",{className:"modal-chip",children:[e.name," ",e.surname,(0,t.jsx)("span",{className:"modal-asignacion-remove-btn",onClick:()=>O(e.document),children:"\xd7"})]},e.document)),(0,t.jsx)("button",{type:"button",className:"modal-asignacion-add-empleado-btn",onClick:()=>D(e=>!e),children:"+"})]}),k&&(0,t.jsxs)("div",{className:"modal-asignacion-dropdown-chip",children:[0===m.length?(0,t.jsx)("div",{className:"modal-asignacion-no-opciones",children:"No hay empleados disponibles"}):m.filter(e=>e.document!==i.document&&!j.find(n=>n.document===e.document)).map(e=>(0,t.jsxs)("button",{onClick:()=>H(e),children:[e.name," ",e.surname]},e.document)),m.length>0&&0===m.filter(e=>e.document!==i.document&&!j.find(n=>n.document===e.document)).length&&(0,t.jsx)("div",{className:"modal-asignacion-no-opciones",children:"Todos los empleados ya est\xe1n asignados"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{children:"Clientes:"}),(0,t.jsxs)("div",{className:"modal-asignacion-dropdown",children:[(0,t.jsxs)("div",{className:"modal-asignacion-dropdown-trigger ".concat(E?"open":""),onClick:()=>A(!E),children:[p?"".concat(p.name," ").concat(p.surname):"Seleccione cliente",(0,t.jsx)("span",{className:"modal-asignacion-arrow",children:"▼"})]}),E&&(0,t.jsx)("div",{className:"modal-asignacion-dropdown-content",children:0===w.length?(0,t.jsxs)("div",{className:"modal-asignacion-no-opciones",children:["No hay clientes disponibles en ",u]}):w.map(e=>{var n;let a=null===(n=e.addresses)||void 0===n?void 0:n.find(e=>e.city===u);return(0,t.jsxs)("button",{onClick:()=>Y(e),className:(null==p?void 0:p.document)===e.document?"selected":"",children:[e.name," ",e.surname,a&&(0,t.jsxs)("span",{className:"modal-asignacion-cliente-direccion",children:["- ",a.address]},"".concat(e.document,"-address"))]},e.document)})})]})]}),(0,t.jsxs)("div",{className:"modal-chip-section",children:[(0,t.jsx)("label",{children:"Servicios:"}),(0,t.jsxs)("div",{className:"modal-chip-container",children:[(0,t.jsxs)("div",{className:"chips",children:[v.map(e=>(0,t.jsxs)("div",{className:"modal-chip",children:[e.description,(0,t.jsx)("span",{className:"modal-asignacion-remove-btn",onClick:()=>J(e.id),children:"\xd7"})]},e.id)),(0,t.jsx)("button",{type:"button",className:"modal-asignacion-add-servicio-btn",onClick:()=>F(e=>!e),children:"+"})]}),M&&(0,t.jsx)("div",{className:"modal-asignacion-dropdown-chip",children:0===b.length?(0,t.jsx)("div",{className:"modal-asignacion-no-opciones",children:"No hay servicios disponibles"}):0===b.filter(e=>!v.some(n=>n.id===e.id)).length?(0,t.jsx)("div",{className:"modal-asignacion-no-opciones",children:"Todos los servicios ya est\xe1n asignados"}):b.filter(e=>!v.some(n=>n.id===e.id)).map(e=>(0,t.jsx)("button",{onClick:()=>P(e),children:e.description},e.id))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{children:"Comentarios:"}),(0,t.jsx)("textarea",{placeholder:"Comentarios adicionales",rows:3,className:"modal-asignacion-textarea",value:C,onChange:e=>S(e.target.value)})]}),(0,t.jsxs)("div",{className:"modal-asignacion-form-buttons modal-asignacion-full-width",children:[(0,t.jsx)("button",{type:"button",onClick:a,className:"modal-asignacion-btn-cancelar",children:"Cancelar"}),(0,t.jsx)("button",{type:"button",className:"modal-asignacion-btn-confirmar",onClick:B,children:"Asignar"})]})]})]})})}},4619:(e,n,a)=>{"use strict";a.d(n,{AX:()=>v,El:()=>m,GZ:()=>l,JV:()=>p,Jq:()=>s,R1:()=>d,Ue:()=>x,VU:()=>u,Yu:()=>c,_U:()=>r,bM:()=>j,co:()=>N,fS:()=>y,g_:()=>g,he:()=>o,qP:()=>w,x_:()=>i,xb:()=>b,z2:()=>h});let t=a(3464).A.create({baseURL:"http://20.42.92.103:8080",headers:{"Content-Type":"application/json"}}),s=async()=>{let{data:e}=await t.get("/service/all");return e},l=async e=>{console.log("Asignando servicio:",e);let{data:n}=await t.post("/schedule",e);return n},c=async()=>{let{data:e}=await t.get("/client");return e},i=async e=>{let{data:n}=await t.get("/client/clientsByCity/".concat(encodeURIComponent(e)));return n},r=async e=>{let{data:n}=await t.post("/client",e);return n},o=async e=>{let{data:n}=await t.get("/client/".concat(e));return n},d=async(e,n)=>{await t.put("/client/".concat(e),n)},u=async()=>{let{data:e}=await t.get("/employee");return e},m=async e=>{let{data:n}=await t.get("/employee/id/".concat(e));return n},h=async e=>{let{data:n}=await t.post("/employee/new",e);return n},p=async e=>{let{data:n}=await t.get("/employee/city/".concat(encodeURIComponent(e)));return n},x=async(e,n)=>{let{data:a}=await t.patch("/employee/update/".concat(e),n);return a},j=async e=>{await t.delete("/employee/delete/".concat(e))},g=async(e,n,a,s)=>{let{data:l}=await t.get("/employee/available",{params:{date:e,startHour:n,endHour:a,city:s}});return l},v=async(e,n,a)=>{let{data:s}=await t.get("/schedule/servicesEmployee/".concat(e),{params:{year:n,month:a}});return s},N=async e=>{let{data:n}=await t.get("/schedule/".concat(e));return n},b=async(e,n,a,s)=>{let l={};a&&(l.city=a),e&&(l.name=e),n&&(l.surname=n);let c=Object.keys(l).length?{params:l}:{},{data:i}=await t.get("/schedule/".concat(s,"/filter"),c);return i},y=async(e,n)=>{console.log("Actualizando servicio con ID:",e,"y datos:",n);let{data:a}=await t.patch("/schedule/".concat(e),n);return a},w=async e=>{await t.delete("/schedule/".concat(e))}},5957:(e,n,a)=>{"use strict";a.r(n),a.d(n,{default:()=>p});var t=a(5155),s=a(2115),l=a(6874),c=a.n(l),i=a(4619),r=a(9521);a(3747);var o=a(6709),d=a(3790),u=a(1720);let m=e=>{let{employee:n,dataServicios:a=[],onDateSelect:l,onButtonClick:c,initialDate:i=null,minDate:r=null,maxDate:m=null,currentMonth:h=null,currentYear:p=null,hideNavigation:x=!1,onServiceUpdate:j,buttonLabels:g=["TURNO 1","TURNO 2"]}=e,[v,N]=(0,s.useState)(()=>null!==h&&null!==p?new Date(p,h,1):new Date),[b,y]=(0,s.useState)(()=>{if(i){let e=new Date(i);return isNaN(e.getTime())?new Date:e}return new Date}),[w,f]=(0,s.useState)(null),[C,S]=(0,s.useState)(!1),[k,D]=(0,s.useState)(null),[E,A]=(0,s.useState)(!1),[M,F]=(0,s.useState)({date:"",shiftIndex:0});(0,s.useEffect)(()=>{null!==h&&null!==p&&N(new Date(p,h,1))},[h,p]);let L=v.getFullYear(),U=v.getMonth(),R=new Date(L,U+1,0).getDate(),I=(0,s.useMemo)(()=>{let e=new Date(L,U,1).getDay();return 0===e?6:e-1},[L,U]),T=(0,s.useCallback)(e=>{if(!e||isNaN(e.getTime()))return"";let n=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),t=String(e.getDate()).padStart(2,"0");return"".concat(n,"-").concat(a,"-").concat(t)},[]),H=(0,s.useCallback)(e=>{let n=new Date;return e===n.getDate()&&U===n.getMonth()&&L===n.getFullYear()},[U,L]),O=(0,s.useCallback)(e=>b.getDate()===e&&b.getMonth()===U&&b.getFullYear()===L,[b,U,L]),P=(0,s.useCallback)(e=>{let n=new Date(L,U,e);return r&&n<r||m&&n>m},[L,U,r,m]),J=(0,s.useCallback)((e,n)=>{if(P(e))return;let a=new Date(L,U,e),t=T(a);y(a),f({day:e,buttonIndex:n,date:t}),null==l||l(t),null==c||c(t,n,g[n])},[L,U,P,T,l,c,g]),Y=(0,s.useCallback)((e,n)=>(null==w?void 0:w.day)===e&&(null==w?void 0:w.buttonIndex)===n,[w]),B=(0,s.useMemo)(()=>{let e=[];for(let n=0;n<I;n++)e.push((0,t.jsx)("div",{className:"modern-date-empty"},"empty-".concat(n)));for(let n=1;n<=R;n++){let s=T(new Date(L,U,n)),l=a.filter(e=>e.serviceDate===s),c=[l.find(e=>e.startHour<"13:00:00"),l.find(e=>e.startHour>="13:00:00")],i=l.reduce((e,n)=>e+(n.totalServiceHours||0),0)>=8,r=H(n),o=O(n),d=P(n),m=["modern-date-container",r&&"modern-date-container-today",o&&"modern-date-container-selected",d&&"modern-date-container-disabled"].filter(Boolean).join(" ");e.push((0,t.jsxs)("div",{className:m,children:[(0,t.jsx)("div",{className:"modern-date-number",children:n}),(0,t.jsx)("div",{className:"modern-date-buttons",children:c.map((e,a)=>{let c=e?e.recurrenceType:i&&l.length>0?l[0].recurrenceType:null,r=null;switch(c){case"PUNTUAL":r="#3B82F6";break;case"FRECUENTE":r="#10B981";break;case"QUINCENAL":r="#FBBF24";break;case"MENSUAL":r="#EF4444"}let o=null;e?o=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{children:"".concat((0,u.e)(e.startHour)," ").concat((0,u.e)(e.endHour))}),(0,t.jsx)("div",{className:"modern-btn-client",children:e.clientCompleteName})]}):i||(o=g[a]);let m=r?{backgroundColor:r,color:"#FFFFFF"}:{},h=["modern-date-button",Y(n,a)&&"modern-date-button-selected",d&&"modern-date-button-disabled"].filter(Boolean).join(" ");return(0,t.jsx)("button",{className:h,style:m,disabled:d,"aria-pressed":Y(n,a),onClick:()=>{J(n,a),e?(D(e),S(!0)):i||(F({date:s,shiftIndex:a}),A(!0))},children:o},"".concat(n,"-").concat(a))})})]},"day-".concat(n)))}return e},[I,R,H,O,P,J,Y,a,T,g]);return(0,t.jsxs)("div",{className:"modern-calendar",role:"application","aria-label":"Calendario de selecci\xf3n de fechas",children:[(0,t.jsx)("div",{className:"modern-month-header",children:(0,t.jsxs)("h2",{className:"modern-month-title ".concat(x?"centered":""),children:[["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][U]," ",L]})}),(0,t.jsx)("div",{className:"modern-weekdays",children:["Lun","Mar","Mi\xe9","Jue","Vie","S\xe1b","Dom"].map((e,n)=>(0,t.jsx)("div",{className:"modern-weekday",children:e},n))}),(0,t.jsx)("div",{className:"modern-calendar-grid",children:B}),C&&k&&(0,t.jsx)(o.A,{service:k,onClose:()=>{S(!1),D(null)},onUpdate:()=>{S(!1),D(null),null==j||j()}}),E&&(0,t.jsx)(d.A,{show:E,onClose:()=>A(!1),empleado:n,date:M.date,startHour:0===M.shiftIndex?"06:00":"14:00",endHour:0===M.shiftIndex?"14:00":"22:00",city:null==n?void 0:n.city,onAssigned:()=>{A(!1),null==j||j()}})]})};a(9471);let h=e=>{let{onDateSelect:n,onButtonClick:a,initialDate:l=null,minDate:c=null,maxDate:i=null,currentMonth:r=null,currentYear:o=null,hideNavigation:d=!1,buttonLabels:u=["DISPONIBLE","OCUPADO","PERMISO/VAC"]}=e,[m,h]=(0,s.useState)(()=>null!==r&&null!==o?new Date(o,r,1):new Date),[p,x]=(0,s.useState)(()=>{if(l){let e=new Date(l);return isNaN(e.getTime())?new Date:e}return new Date}),[j,g]=(0,s.useState)(null);(0,s.useEffect)(()=>{null!==r&&null!==o&&h(new Date(o,r,1))},[r,o]);let v=m.getFullYear(),N=m.getMonth(),b=new Date(v,N+1,0).getDate(),y=(0,s.useMemo)(()=>{let e=new Date(v,N,1).getDay();return 0===e?6:e-1},[v,N]),w=(0,s.useCallback)(e=>{if(!e||isNaN(e.getTime()))return"";let n=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),t=String(e.getDate()).padStart(2,"0");return"".concat(n,"-").concat(a,"-").concat(t)},[]),f=(0,s.useCallback)(e=>{let n=new Date;return e===n.getDate()&&N===n.getMonth()&&v===n.getFullYear()},[N,v]),C=(0,s.useCallback)(e=>p.getDate()===e&&p.getMonth()===N&&p.getFullYear()===v,[p,N,v]),S=(0,s.useCallback)(e=>{let n=new Date(v,N,e);return c&&n<c||i&&n>i},[v,N,c,i]),k=(0,s.useCallback)((e,t)=>{if(S(e))return;let s=new Date(v,N,e),l=w(s);x(s),g({day:e,buttonIndex:t,date:l}),null==n||n(l),null==a||a(l,t,u[t])},[v,N,S,w,n,a,u]),D=(0,s.useCallback)((e,n)=>(null==j?void 0:j.day)===e&&(null==j?void 0:j.buttonIndex)===n,[j]),E=(0,s.useMemo)(()=>{let e=[];for(let n=0;n<y;n++)e.push((0,t.jsx)("div",{className:"calendar-date-empty"},"empty-".concat(n)));for(let n=1;n<=b;n++){let a=f(n),s=C(n),l=S(n),c=["calendar-date-container",a&&"calendar-date-container-today",s&&"calendar-date-container-selected",l&&"calendar-date-container-disabled"].filter(Boolean).join(" ");e.push((0,t.jsxs)("div",{className:c,children:[(0,t.jsx)("div",{className:"calendar-date-number",children:n}),(0,t.jsx)("div",{className:"calendar-date-buttons",children:u.map((e,a)=>{let s=D(n,a),c=["calendar-date-button","calendar-date-button-".concat(a),s&&"calendar-date-button-selected",l&&"calendar-date-button-disabled"].filter(Boolean).join(" ");return(0,t.jsx)("button",{className:c,onClick:()=>k(n,a),disabled:l,"aria-label":"".concat(e," del ").concat(n," de ").concat(m.toLocaleDateString("es-ES",{month:"long"})," ").concat(v),"aria-pressed":s,children:e},"".concat(n,"-").concat(a))})})]},"day-".concat(n)))}return e},[y,b,f,C,S,k,D,m,v,u]);return(0,t.jsxs)("div",{className:"three-button-calendar",role:"application","aria-label":"Calendario de selecci\xf3n de fechas",children:[(0,t.jsx)("div",{className:"calendar-month-header",children:(0,t.jsxs)("h2",{className:"calendar-month-title ".concat(d?"centered":""),children:[["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][N]," ",v]})}),(0,t.jsx)("div",{className:"calendar-weekdays",children:["Lun","Mar","Mi\xe9","Jue","Vie","S\xe1b","Dom"].map((e,n)=>(0,t.jsx)("div",{className:"calendar-weekday",children:e},n))}),(0,t.jsx)("div",{className:"calendar-grid",children:E})]})},p=()=>{let[e,n]=(0,s.useState)(""),[a,l]=(0,s.useState)(new Date().getMonth()),[o,d]=(0,s.useState)(new Date().getFullYear()),[u,p]=(0,s.useState)(""),{ciudades:x,isLoading:j,isError:g}=(0,r.k)(),[v,N]=(0,s.useState)([]),[b,y]=(0,s.useState)(null),[w,f]=(0,s.useState)([]),[C,S]=(0,s.useState)(!1),[k,D]=(0,s.useState)(!1),[E,A]=(0,s.useState)(!1),[M,F]=(0,s.useState)(!1),L=(0,s.useRef)(null),U=(0,s.useRef)(null),R=(0,s.useRef)(null),I=(0,s.useRef)(null),T=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],H=new Date().getFullYear(),O=Array.from({length:11},(e,n)=>H-5+n);(0,s.useEffect)(()=>{u?(0,i.JV)(u).then(e=>{N(e),y(null)}).catch(()=>{N([]),y(null)}):(N([]),y(null))},[u]),(0,s.useEffect)(()=>{if(!b){f([]);return}let e=a+1;(0,i.AX)(b.document,o,e).then(e=>f(e)).catch(e=>{console.error(e),f([])})},[b,a,o]),(0,s.useEffect)(()=>{let e=e=>{L.current&&!L.current.contains(e.target)&&S(!1),U.current&&!U.current.contains(e.target)&&D(!1),R.current&&!R.current.contains(e.target)&&A(!1),I.current&&!I.current.contains(e.target)&&F(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let P=e=>{n(e)},J=(e,n)=>{l(n),S(!1)},Y=e=>{d(e),D(!1)},B=e=>{p(e),A(!1)},V=e=>{y(e),F(!1)};return(0,t.jsx)("div",{style:{width:"100vw",height:"180vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",position:"relative"},children:(0,t.jsxs)("div",{className:"container",style:{height:"170vh",marginLeft:"0.5cm",marginTop:"0.5cm"},children:[(0,t.jsxs)("div",{style:{width:"240px",height:"100%",marginRight:"auto",padding:"20px",boxShadow:"2px 0px 10px rgba(0, 0, 0, 0.2)",display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,t.jsxs)(c(),{href:"/servicios",className:"btn-53",children:[(0,t.jsx)("div",{className:"original",children:"⬅ Regresar"}),(0,t.jsxs)("div",{className:"letters",children:[(0,t.jsx)("span",{children:"M"}),(0,t.jsx)("span",{children:"E"}),(0,t.jsx)("span",{children:"N"}),(0,t.jsx)("span",{children:"\xda"})]})]}),(0,t.jsx)("div",{className:"menu-buttons",children:(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:(0,t.jsxs)("div",{className:"dropdown",ref:L,children:[(0,t.jsxs)("button",{type:"button",className:"dropdown-trigger ".concat(C?"open":""),onClick:()=>S(!C),children:[(0,t.jsx)("span",{children:T[a]}),(0,t.jsx)("span",{className:"arrow",children:"▼"})]}),C&&(0,t.jsx)("div",{className:"dropdown-content",children:T.map((e,n)=>(0,t.jsx)("button",{type:"button",className:a===n?"selected":"",onClick:()=>J(e,n),children:e},n))})]})}),(0,t.jsx)("li",{children:(0,t.jsxs)("div",{className:"dropdown",ref:U,children:[(0,t.jsxs)("button",{type:"button",className:"dropdown-trigger ".concat(k?"open":""),onClick:()=>D(!k),children:[(0,t.jsx)("span",{children:o}),(0,t.jsx)("span",{className:"arrow",children:"▼"})]}),k&&(0,t.jsx)("div",{className:"dropdown-content",children:O.map(e=>(0,t.jsx)("button",{type:"button",className:o===e?"selected":"",onClick:()=>Y(e),children:e},e))})]})}),(0,t.jsx)("li",{children:(0,t.jsxs)("div",{className:"dropdown",ref:R,children:[(0,t.jsxs)("button",{type:"button",className:"dropdown-trigger ".concat(E?"open":""," ").concat(u?"city-selected":""),onClick:()=>A(!E),children:[(0,t.jsx)("span",{children:u||"Seleccionar ciudad"}),(0,t.jsx)("span",{className:"arrow",children:"▼"})]}),E&&(0,t.jsxs)("div",{className:"dropdown-content",children:[u&&(0,t.jsx)("button",{type:"button",className:"clear-option",onClick:()=>B(""),children:"Limpiar selecci\xf3n"}),j&&(0,t.jsx)("div",{children:"Cargando ciudades..."}),g&&(0,t.jsx)("div",{children:"Error al cargar ciudades"}),!j&&!g&&x.map((e,n)=>(0,t.jsx)("button",{type:"button",className:u===e?"selected":"",onClick:()=>B(e),children:e},n))]})]})}),v.length>0&&(0,t.jsx)("li",{children:(0,t.jsxs)("div",{className:"dropdown",ref:I,children:[(0,t.jsxs)("button",{type:"button",className:"dropdown-trigger ".concat(M?"open":""," ").concat(b?"employee-selected":""),onClick:()=>F(!M),children:[(0,t.jsx)("span",{children:b?"".concat(b.name," ").concat(b.surname):"Selec. empleado"}),(0,t.jsx)("span",{className:"arrow",children:"▼"})]}),M&&(0,t.jsxs)("div",{className:"dropdown-content",children:[b&&(0,t.jsx)("button",{type:"button",className:"clear-option",onClick:()=>V(null),children:"Limpiar selecci\xf3n"}),v.map(e=>(0,t.jsxs)("button",{type:"button",className:(null==b?void 0:b.document)===e.document?"selected":"",onClick:()=>V(e),children:[e.name," ",e.surname]},e.document))]})]})})]})})]}),b?(0,t.jsx)(m,{employee:b,dataServicios:w,onDateSelect:P,currentMonth:a,currentYear:o,hideNavigation:!0,onServiceUpdate:()=>{if(!b){f([]);return}let e=a+1;(0,i.AX)(b.document,o,e).then(e=>f(e)).catch(e=>{console.error(e),f([])})}}):(0,t.jsx)(h,{onDateSelect:P,onButtonClick:(e,n,a)=>{console.log("".concat(a," seleccionado para ").concat(e,", empleado: ").concat((null==b?void 0:b.name)||"ninguno"))},currentMonth:a,currentYear:o,hideNavigation:!0,buttonLabels:["DISPONIBLE","OCUPADO","PERMISO/VAC"]})]})})}},6709:(e,n,a)=>{"use strict";a.d(n,{A:()=>r});var t=a(5155),s=a(2115),l=a(4619),c=a(9521),i=a(1720);let r=e=>{let{service:n,onClose:a,onUpdate:r}=e,o=(0,c.p)({startHour:6,endHour:18,stepMinutes:30}),[d,u]=(0,s.useState)([]),[m,h]=(0,s.useState)([]),[p,x]=(0,s.useState)([]),[j,g]=(0,s.useState)([]),[v,N]=(0,s.useState)(""),[b,y]=(0,s.useState)(n.startHour||""),[w,f]=(0,s.useState)(n.endHour||""),[C,S]=(0,s.useState)(n.state||""),[k,D]=(0,s.useState)(!1),[E,A]=(0,s.useState)(!1),[M,F]=(0,s.useState)(!1),[L,U]=(0,s.useState)(!1),[R,I]=(0,s.useState)(!1),T=(0,s.useRef)(null),H=(0,s.useRef)(null),O=(0,s.useRef)(null);(0,s.useEffect)(()=>{n.services&&u(n.services.map(e=>({id:e.idService,description:e.serviceDescription}))),n.employees&&h(n.employees.map(e=>({document:e.employeeDocument,employeeCompleteName:e.employeeCompleteName}))),N(n.comments||""),(0,l.VU)().then(g).catch(()=>g([])),(0,l.Jq)().then(x).catch(()=>x([]))},[n]),(0,s.useEffect)(()=>{let e=e=>{T.current&&!T.current.contains(e.target)&&D(!1),H.current&&!H.current.contains(e.target)&&A(!1),O.current&&!O.current.contains(e.target)&&F(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let P=async()=>{let e={...n,startHour:b,endHour:w,state:C,employeeDocuments:m.map(e=>e.document),idServices:d.map(e=>e.id),comments:v};await (0,l.fS)(n.id,e),null==r||r(),a()},J=async()=>{confirm("\xbfEliminar este servicio?")&&(await (0,l.qP)(n.id),null==r||r(),a())};return(0,t.jsx)("div",{className:"modal-overlay",onClick:a,children:(0,t.jsxs)("div",{className:"modal-container",onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:"modal-datos-superiores",style:{justifyContent:"flex-start",gap:"2rem"},children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,t.jsx)("span",{children:"Hora Inicio"}),(0,t.jsxs)("div",{className:"dropdown",ref:T,children:[(0,t.jsxs)("button",{type:"button",className:"dropdown-trigger ".concat(k?"open":""),onClick:()=>D(e=>!e),children:[(0,t.jsx)("span",{children:(0,i.e)(b)||"Hora inicio"}),(0,t.jsx)("span",{className:"arrow",children:"▼"})]}),k&&(0,t.jsx)("div",{className:"dropdown-content",children:o.map(e=>{let{value:n,label:a}=e;return(0,t.jsx)("button",{onClick:()=>{y(n),D(!1)},children:a},n)})})]})]}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,t.jsx)("span",{children:"Hora Fin"}),(0,t.jsxs)("div",{className:"dropdown",ref:H,children:[(0,t.jsxs)("button",{type:"button",className:"dropdown-trigger ".concat(E?"open":""),onClick:()=>A(e=>!e),children:[(0,t.jsx)("span",{children:(0,i.e)(w)||"Hora fin"}),(0,t.jsx)("span",{className:"arrow",children:"▼"})]}),E&&(0,t.jsx)("div",{className:"dropdown-content",children:o.map(e=>{let{value:n,label:a}=e;return(0,t.jsx)("button",{onClick:()=>{f(n),A(!1)},children:a},n)})})]})]}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,t.jsx)("span",{children:"Estado"}),(0,t.jsxs)("div",{className:"dropdown",ref:O,children:[(0,t.jsxs)("button",{type:"button",className:"dropdown-trigger ".concat(M?"open":""),onClick:()=>F(e=>!e),children:[(0,t.jsx)("span",{children:C||"Estado"}),(0,t.jsx)("span",{className:"arrow",children:"▼"})]}),M&&(0,t.jsx)("div",{className:"dropdown-content",children:["PROGRAMADA","COMPLETADA","CANCELADA"].map(e=>(0,t.jsx)("button",{onClick:()=>{S(e),F(!1)},children:e},e))})]})]})]}),(0,t.jsxs)("div",{className:"modal-asignacion-form-grid",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{children:"Cliente"}),(0,t.jsx)("input",{type:"text",readOnly:!0,value:n.clientCompleteName||""})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{children:"Direcci\xf3n"}),(0,t.jsx)("input",{type:"text",readOnly:!0,value:n.addressService||""})]}),(0,t.jsxs)("div",{className:"modal-chip-section",children:[(0,t.jsx)("label",{children:"Servicios:"}),(0,t.jsxs)("div",{className:"modal-chip-container",children:[(0,t.jsxs)("div",{className:"chips",children:[d.map(e=>(0,t.jsxs)("div",{className:"modal-chip",children:[e.description,(0,t.jsx)("span",{className:"modal-asignacion-remove-btn",onClick:()=>u(d.filter(n=>n.id!==e.id)),children:"\xd7"})]},e.id)),(0,t.jsx)("button",{type:"button",className:"modal-asignacion-add-servicio-btn",onClick:()=>U(e=>!e),children:"+"})]}),L&&(0,t.jsx)("div",{className:"modal-asignacion-dropdown-chip",children:p.filter(e=>!d.find(n=>n.id===e.id)).map(e=>(0,t.jsx)("button",{onClick:()=>{u([...d,{id:e.id,description:e.description}]),U(!1)},children:e.description},e.id))})]})]}),(0,t.jsxs)("div",{className:"modal-chip-section",children:[(0,t.jsx)("label",{children:"Personal Asignado:"}),(0,t.jsxs)("div",{className:"modal-chip-container",children:[(0,t.jsxs)("div",{className:"chips",children:[m.map(e=>(0,t.jsxs)("div",{className:"modal-chip",children:[e.employeeCompleteName,(0,t.jsx)("span",{className:"modal-asignacion-remove-btn",onClick:()=>h(m.filter(n=>n.document!==e.document)),children:"\xd7"})]},e.document)),(0,t.jsx)("button",{type:"button",className:"modal-asignacion-add-empleado-btn",onClick:()=>I(e=>!e),children:"+"})]}),R&&(0,t.jsx)("div",{className:"modal-asignacion-dropdown-chip",children:j.filter(e=>!m.some(n=>n.document===e.document)).map(e=>(0,t.jsxs)("button",{onClick:()=>{h([...m,{document:e.document,employeeCompleteName:"".concat(e.name," ").concat(e.surname)}]),I(!1)},children:[e.name," ",e.surname]},e.document))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{children:"Ciudad"}),(0,t.jsx)("input",{type:"text",readOnly:!0,value:n.city||""})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{children:"Comentarios"}),(0,t.jsx)("textarea",{rows:3,className:"modal-asignacion-textarea",value:v,onChange:e=>N(e.target.value)})]})]}),(0,t.jsxs)("div",{className:"modal-asignacion-form-buttons",children:[(0,t.jsx)("button",{className:"modal-asignacion-btn-confirmar",onClick:P,children:"Guardar Cambios"}),(0,t.jsx)("button",{className:"modal-asignacion-btn-eliminar",onClick:J,children:"Eliminar"}),(0,t.jsx)("button",{className:"modal-asignacion-btn-cancelar",onClick:a,children:"Cerrar"})]})]})})}},9471:()=>{},9521:(e,n,a)=>{"use strict";a.d(n,{k:()=>c,p:()=>i});var t=a(838),s=a(2115);let l=e=>fetch(e).then(e=>{if(!e.ok)throw Error("Error al cargar ciudades");return e.json()});function c(){let e="http://20.42.92.103:8080",{data:n,error:a}=(0,t.Ay)(e?"".concat(e,"/client/cities"):null,l);return{ciudades:n||[],isLoading:!a&&!n,isError:!!a}}function i(){let{startHour:e=6,endHour:n=18,stepMinutes:a=30}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.useMemo)(()=>{let t=[];for(let s=e;s<n;s++)for(let e=0;e<60;e+=a){let n="".concat(String(s).padStart(2,"0"),":").concat(String(e).padStart(2,"0")),a=new Date;a.setHours(s,e);let l=a.toLocaleTimeString([],{hour:"numeric",minute:"2-digit"});t.push({value:n,label:l})}return t},[e,n,a])}}}]);